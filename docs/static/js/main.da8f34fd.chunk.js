(this.webpackJsonpmask_simulation=this.webpackJsonpmask_simulation||[]).push([[0],{24:function(e,t,n){var a=n(74),o=[];e.exports=function(){var e=new Worker(n.p+"e66cde783390edbe6aa2.worker.js",{name:"[hash].worker.js"});return a(e,o),e}},67:function(e,t,n){e.exports=n(78)},72:function(e,t,n){},73:function(e,t,n){},75:function(e,t,n){},76:function(e,t,n){},77:function(e,t,n){},78:function(e,t,n){"use strict";n.r(t);var a=n(0),o=n.n(a),i=n(23),c=n.n(i),r=(n(72),n(73),n(2)),s=n(80),u=n(3);function l(e,t){var n=Object(a.useRef)();Object(a.useEffect)((function(){n.current=e}),[e]),Object(a.useEffect)((function(){if(null!==t){var e=setInterval((function(){n.current()}),t);return function(){return clearInterval(e)}}}),[t])}var h,d,v,f,m=n(24),b=n.n(m),g=n(1),j=0,O=1,p=2,M=0,k=1,E=2,w=(h={},Object(g.a)(h,M,1),Object(g.a)(h,k,.67),Object(g.a)(h,E,.55),h),N=(d={},Object(g.a)(d,j,"#BB641D"),Object(g.a)(d,O,"#AAC6CA"),Object(g.a)(d,p,"#CB8AC0"),d),y=(v={},Object(g.a)(v,M,0),Object(g.a)(v,k,3),Object(g.a)(v,E,4),v),S=(f={},Object(g.a)(f,M,"#fff"),Object(g.a)(f,k,"#000"),Object(g.a)(f,E,"#000"),f),T=function(e){var t=e.disease_status;return N[t]},R=function(e){var t=e.mask_status;return S[t]},C=function(e){var t=e.mask_status;return y[t]};function I(e,t,n,a){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:2;e.beginPath(),e.arc(t.x,t.y,t.radius-(o?o/2:0),0,2*Math.PI,!1),o>0&&(e.save(),e.strokeStyle=a||"none",e.lineWidth=o,e.stroke(),e.restore()),e.fillStyle=n,e.strokeStyle=a||"none",e.fill()}function A(){}function x(e){var t=e.onClick,n=e.className,i=e.drawFunction,c=void 0===i?function(){}:i,r=e.height,s=void 0===r?500:r,l=e.width,h=void 0===l?500:l,d=e.canvasPixelRatio,v=void 0===d?2:d,f=e.onMouseDown,m=e.onMouseMove,b=e.onMouseUp,g=e.style,j=void 0===g?{}:g,O=e.onTouchEnd,p=e.onTouchMove,M=e.onTouchStart,k=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=Object(a.useRef)(null);return Object(a.useEffect)((function(){var a=n.current,o=a.getContext("2d");var i=requestAnimationFrame((function(){o.clearRect(0,0,a.width,a.height),o.save(),o.scale(t,t),e(o),o.restore()}));return function(){return cancelAnimationFrame(i)}}),[e,t]),n}(c,v),E={width:"".concat(h,"px"),height:"".concat(s,"px")};return o.a.createElement("canvas",{className:n,width:h*v,height:s*v,style:Object(u.a)(Object(u.a)({},E),j),ref:k,onTouchStart:M,onTouchMove:p,onTouchEnd:O,onMouseMove:m,onMouseDown:f,onMouseUp:b,onClick:t})}n(75);var _=n(5),B=(n(76),j),L=O,P=p;function U(e){var t=e.handleMouseMove,n=e.handleTouchMove,i=e.handleMouseLeave,c=e.height,s=e.margin,u=void 0===s?{top:5,left:5,bottom:5,right:5}:s,l=e.transitionDuration,h=void 0===l?1e3:l,d=e.virusHistory,v=e.nNodes,f=e.width,m=Object(a.useMemo)((function(){for(var e=2*String(d.length).length||1,t=[],n=0;n<d.length;n+=e)t.push(d[n]);return[t]}),[d]),b=Object(r.a)(m,1)[0],g=Object(a.useMemo)((function(){return[c-u.top-u.bottom,f-u.left-u.right]}),[f,c,u]),j=Object(r.a)(g,2),O=j[0],p=j[1],M=Object(a.useMemo)((function(){if(b.length){var e=Math.max(b[b.length-1].tick,2e3);return Object(_.b)().domain([0,e]).range([0,p])}return Object(_.b)()}),[b,p]),k=Object(a.useMemo)((function(){return Object(_.b)().domain([0,v]).range([O,0])}),[v,O]),E=Object(a.useMemo)((function(){return Object(_.d)().keys([B,L,P])(b)}),[b]),w=Object(a.useRef)();return Object(a.useLayoutEffect)((function(){var e=Object(_.a)().x((function(e){return M(e.data.tick)})).y0((function(e){return k(e[0])})).y1((function(e){return k(e[1])}));Object(_.c)(w.current).selectAll("path").data(E).join("path").attr("d",e).attr("fill",(function(e){var t=e.key;return N[t]}))}),[E,w,h,M,k]),o.a.createElement("div",{className:"stacked-area-chart-wrapper"},o.a.createElement("svg",{onMouseMove:t,onTouchMove:n,onMouseLeave:i,onTouchEnd:i,height:"100%",width:"100%",viewBox:"0 0 ".concat(f," ").concat(c),preserveAspectRatio:"none",overflow:"hidden"},o.a.createElement("g",{transform:"translate(".concat(u.left,", ").concat(u.top,")"),ref:w})))}var W=function(e){var t=e.positionNodes,n=void 0===t?[]:t,a=e.virusNodes,o=void 0===a?[]:a;return function(e){return function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:T,o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:R,i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:C;t.forEach((function(t,c){return I(e,t,a(n[c]),o(n[c]),i(n[c]))}))}(e,n,o)}};function D(e){var t=e.simulationState,n=(t=void 0===t?{}:t).isRunning,i=t.isStasisReached,c=t.positionNodes,r=void 0===c?[]:c,s=t.virusSimulations,u=e.handleClick,l=e.height,h=e.width,d=Object(a.useMemo)((function(){return i?"(touch to start a new simulation)":!0===n?"(touch to pause)":!1===n?"(touch to resume)":""}),[n,i]);return o.a.createElement("div",{className:"multi-simulation-container"},s&&s.map((function(e,t){var n=e.title,a=e.percentMasked,i=e.virusHistory,c=e.virusNodes;return o.a.createElement("div",{className:"simulation-group-container",key:"sim-canvas-".concat(t)},o.a.createElement("div",{className:"simulation-canvas-labels",onClick:u},o.a.createElement("span",{className:"simulation-title"},n||"".concat(a,"% mask use")),o.a.createElement("span",{className:"interaction-label"},d)),o.a.createElement(x,{className:"simulation-canvas",drawFunction:W({positionNodes:r,virusNodes:c}),onClick:u,ontouchend:u,height:l,width:h}),o.a.createElement(U,{nNodes:c.length,virusHistory:i,height:60,width:h}))})))}var F={attackSuccessProbability:.05,historyInterval:3,nNodes:40,radius:7,ticksToRecover:1e3,velocity:3.5,virusSimulations:[{title:"No mask use",maskedType:k,nInfected:3,percentMasked:0,maskTransmissionReduction:w},{title:"95% mask use",maskedType:k,nInfected:3,percentMasked:95,maskTransmissionReduction:w}]};function H(e){var t=e.simulationProps,n=void 0===t?F:t,i=e.height,c=void 0===i?400:i,s=e.margin,h=void 0===s?{top:20,left:20,bottom:20,right:20}:s,d=e.width,v=void 0===d?400:d,f=Object(a.useState)({}),m=Object(r.a)(f,2),g=m[0],j=m[1],O=Object(a.useMemo)((function(){var e=v>600?2:1,t=Math.min(c-h.top-h.bottom,(v-(h.left-h.right)*e)/e);return[t,t]}),[c,v,h]),p=Object(r.a)(O,2),M=p[0],k=p[1],E=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:A,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,o=Object(a.useState)(null),i=Object(r.a)(o,2),c=i[0],s=i[1];return l((function(){c&&c.postMessage({action:"TICK"})}),n),Object(a.useEffect)((function(){if(!c){var n=new b.a;n.postMessage(Object(u.a)({action:"NEW_SIMULATION"},e)),n.addEventListener("message",(function(e){t(e.data)})),s(n)}}),[c,s,t,e]),[c,s]}(Object(u.a)({height:M,width:k},n),j),w=Object(r.a)(E,1)[0];Object(a.useEffect)((function(){w&&w.postMessage({action:"RESIZE",height:M,width:k})}),[M,k,w]);var N=Object(a.useCallback)((function(){g.isStasisReached?w.postMessage(Object(u.a)({action:"NEW_SIMULATION",height:M,width:k},n)):!0===g.isRunning?w.postMessage({action:"PAUSE"}):!1===g.isRunning&&w.postMessage({action:"RESUME"})}),[w,M,k,n,g]);return o.a.createElement(D,{simulationState:g,handleClick:N,height:M,width:k})}n(77);function J(){var e=Object(s.a)(),t=Object(r.a)(e,2),n=t[0],a=t[1],i=a.height,c=a.width;return o.a.createElement("div",{className:"mask-simulation-container",ref:n},o.a.createElement(H,{height:i,width:c}))}var q=function(){return o.a.createElement("div",{className:"App"},o.a.createElement(J,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));c.a.render(o.a.createElement(o.a.StrictMode,null,o.a.createElement(q,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[67,1,2]]]);
//# sourceMappingURL=main.da8f34fd.chunk.js.map